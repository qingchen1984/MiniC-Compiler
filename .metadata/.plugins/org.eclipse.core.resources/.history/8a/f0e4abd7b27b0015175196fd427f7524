package io;

import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Scanner;

public class Scan {
	
	private LinkedList<String> list;
	private Iterator<String> iter;
	
	public Scan(String filename){
		
	}
	
	public String getNextWord(){
		if(iter.hasNext()){
			return iter.next();
		} else {
			return null;
		}
	}
	
	public static void main(String[] args){
		File sourceFile = new File("input/source1.c");
		ArrayList<Character> trans = new ArrayList<Character>();
		try {
			//DataInputStream in = new DataInputStream(new FileInputStream(sourceFile));
			FileInputStream in = new FileInputStream(sourceFile);
			char ch1 = ' ';
			char ch2 = ' ';//用于在验证是否为引号内结尾或者注释结尾
			while(in.available()>1){
				if(ch2 != ' '){
					ch1 = ch2;
				} else {
					ch1 = (char) in.read();
				}
				if(ch1 == '\n'){
					trans.add(' ');
				}
				
				if(ch1 == '\''){//避免删除空白时将‘’包含的空白字符剔除
					trans.add(ch1);
					trans.add((char)in.read());
					trans.add((char)in.read());
				} else if (ch1 == '\"'){//避免将字符串中的空白剔除
					trans.add(ch1);
					while(in.available()>0){
						ch1 = (char)in.read();
						trans.add(ch1);
						if(ch1 == '\"'){
							break;
						}
					}
				} else if (ch1 == '/'){//剔除字符串
					ch2 = (char)in.read();
					if(ch2 == '/'){
						while(in.available() > 0){
							ch2 = (char)in.read();
							if(ch2 == '\n'){
								break;
							}
						}
						ch2 = ' ';
					} else if (ch2 == '*') {
						while(in.available() > 0){
							ch1 = (char)in.read();
							if(ch1 == '*'){
								ch2 = (char)in.read();
								if(ch2 == '/'){
									break;
								}
							}
						}
					} else {
						if(ch2 == ' '){
							while(ch2 == ' '){
								ch2 = (char)in.read();
							}
						}
						trans.add(ch1);
						trans.add(ch2);
						ch2 = ' ';
					}
				} else if(ch1 == ' '){
					if(trans.get(trans.size()-1) == ' '){
						continue;
					} else {
						trans.add(' ');
					}
				} else {
					trans.add(ch1);
				}
			}
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
		char[] chStr = new char[trans.size()];
		for(int i = 0;i < trans.size();i++){
			chStr[i] = trans.get(i).charValue();
		}
		String result = new String(chStr);
		System.out.println(result);
		for(int i = 0;i < result.length();i++){
			if(result.charAt(i) == '\n'){
				System.out.println("日了狗了");
			}
		}
	}

}
